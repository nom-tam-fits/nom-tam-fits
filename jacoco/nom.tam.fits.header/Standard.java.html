<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Standard.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">nom.tam FITS library</a> &gt; <a href="index.source.html" class="el_package">nom.tam.fits.header</a> &gt; <span class="el_source">Standard.java</span></div><h1>Standard.java</h1><pre class="source lang-java linenums">package nom.tam.fits.header;

import nom.tam.fits.AsciiTable;
import nom.tam.fits.BasicHDU;
import nom.tam.fits.BinaryTable;
import nom.tam.fits.ImageData;
import nom.tam.fits.RandomGroupsData;
import nom.tam.fits.TableData;
import nom.tam.fits.UndefinedData;

/*
 * #%L
 * nom.tam FITS library
 * %%
 * Copyright (C) 1996 - 2021 nom-tam-fits
 * %%
 * This is free and unencumbered software released into the public domain.
 * 
 * Anyone is free to copy, modify, publish, use, compile, sell, or
 * distribute this software, either in source code form or as a compiled
 * binary, for any purpose, commercial or non-commercial, and by any
 * means.
 * 
 * In jurisdictions that recognize copyright laws, the author or authors
 * of this software dedicate any and all copyright interest in the
 * software to the public domain. We make this dedication for the benefit
 * of the public at large and to the detriment of our heirs and
 * successors. We intend this dedication to be an overt act of
 * relinquishment in perpetuity of all present and future rights to this
 * software under copyright law.
 * 
 * THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
 * IN NO EVENT SHALL THE AUTHORS BE LIABLE FOR ANY CLAIM, DAMAGES OR
 * OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,
 * ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 * #L%
 */

/**
 * This data dictionary lists the 53 keywords currently defined in the FITS
 * Standard.
 * 
 * &lt;pre&gt;
 *  @see &lt;a href=&quot;http://heasarc.gsfc.nasa.gov/docs/fcg/standard_dict.html&quot;&gt;http://heasarc.gsfc.nasa.gov/docs/fcg/standard_dict.html&lt;/a&gt;
 * &lt;/pre&gt;
 * 
 * @author Richard van Nieuwenhoven
 */
<span class="fc" id="L52">public enum Standard implements IFitsHeader {</span>
    /**
     * The value field shall contain a character string identifying who compiled
     * the information in the data associated with the key. This keyword is
     * appropriate when the data originate in a published paper or are compiled
     * from many sources.
     */
<span class="fc" id="L59">    AUTHOR(SOURCE.RESERVED, HDU.ANY, VALUE.STRING, &quot;author of the data&quot;),</span>
    /**
     * The value field shall contain an integer. The absolute value is used in
     * computing the sizes of data structures. It shall specify the number of
     * bits that represent a data value. RANGE: -64,-32,8,16,32
     */
<span class="fc" id="L65">    BITPIX(SOURCE.MANDATORY, HDU.ANY, VALUE.INTEGER, &quot;bits per data value&quot;, //</span>
<span class="fc" id="L66">            replaceable(&quot;header:bitpix&quot;, Object.class) //</span>
    ),
    /**
     * This keyword shall be used only in primary array headers or IMAGE
     * extension headers with positive values of BITPIX (i.e., in arrays with
     * integer data). Columns 1-8 contain the string, `BLANK ' (ASCII blanks in
     * columns 6-8). The value field shall contain an integer that specifies the
     * representation of array values whose physical values are undefined.
     */
<span class="fc" id="L75">    BLANK(SOURCE.RESERVED, HDU.IMAGE, VALUE.INTEGER, &quot;value used for undefined array elements&quot;),</span>

    /**
     * Columns 1-8 contain ASCII blanks. This keyword has no associated value.
     * Columns 9-80 may contain any ASCII text. Any number of card images with
     * blank keyword fields may appear in a key.
     */
<span class="fc" id="L82">    BLANKS(&quot;        &quot;, SOURCE.RESERVED, HDU.ANY, VALUE.NONE, null),</span>

    /**
     * This keyword may be used only in the primary key. It shall appear within
     * the first 36 card images of the FITS file. (Note: This keyword thus
     * cannot appear if NAXIS is greater than 31, or if NAXIS is greater than 30
     * and the EXTEND keyword is present.) Its presence with the required
     * logical value of T advises that the physical block size of the FITS file
     * on which it appears may be an integral multiple of the logical record
     * length, and not necessarily equal to it. Physical block size and logical
     * record length may be equal even if this keyword is present or unequal if
     * it is absent. It is reserved primarily to prevent its use with other
     * meanings. Since the issuance of version 1 of the standard, the BLOCKED
     * keyword has been deprecated.
     * 
     * @deprecated no blocksize other that 2880 may be used.
     */
<span class="fc" id="L99">    @Deprecated</span>
    BLOCKED(SOURCE.RESERVED, HDU.PRIMARY, VALUE.LOGICAL, &quot;is physical blocksize a multiple of 2880?&quot;),

    /**
     * This keyword shall be used, along with the BZERO keyword, when the array
     * pixel values are not the true physical values, to transform the primary
     * data array values to the true physical values they represent, using the
     * equation: physical_value = BZERO + BSCALE * array_value. The value field
     * shall contain a floating point number representing the coefficient of the
     * linear term in the scaling equation, the ratio of physical value to array
     * value at zero offset. The default value for this keyword is 1.0.
     */
<span class="fc" id="L111">    BSCALE(SOURCE.RESERVED, HDU.IMAGE, VALUE.REAL, &quot;linear factor in scaling equation&quot;),</span>

    /**
     * The value field shall contain a character string, describing the physical
     * units in which the quantities in the array, after application of BSCALE
     * and BZERO, are expressed. The units of all FITS key keyword values, with
     * the exception of measurements of angles, should conform with the
     * recommendations in the IAU Style Manual. For angular measurements given
     * as floating point values and specified with reserved keywords, degrees
     * are the recommended units (with the units, if specified, given as 'deg').
     */
<span class="fc" id="L122">    BUNIT(SOURCE.RESERVED, HDU.IMAGE, VALUE.STRING, &quot;physical units of the array values&quot;),</span>

    /**
     * This keyword shall be used, along with the BSCALE keyword, when the array
     * pixel values are not the true physical values, to transform the primary
     * data array values to the true values using the equation: physical_value =
     * BZERO + BSCALE * array_value. The value field shall contain a floating
     * point number representing the physical value corresponding to an array
     * value of zero. The default value for this keyword is 0.0.
     */
<span class="fc" id="L132">    BZERO(SOURCE.RESERVED, HDU.IMAGE, VALUE.REAL, &quot;zero point in scaling equation&quot;),</span>

    /**
     * The value field shall contain a floating point number giving the partial
     * derivative of the coordinate specified by the CTYPEn keywords with
     * respect to the pixel index, evaluated at the reference point CRPIXn, in
     * units of the coordinate specified by the CTYPEn keyword. These units must
     * follow the prescriptions of section 5.3 of the FITS Standard.
     */
<span class="fc" id="L141">    CDELTn(SOURCE.RESERVED, HDU.IMAGE, VALUE.REAL, &quot;coordinate increment along axis&quot;),</span>

    /**
     * This keyword shall have no associated value; columns 9-80 may contain any
     * ASCII text. Any number of COMMENT card images may appear in a key.
     */
<span class="fc" id="L147">    COMMENT(SOURCE.RESERVED, HDU.ANY, VALUE.NONE, null),</span>

    /**
     * The CONTINUE keyword, when followed by spaces in columns 9 and 10 of the
     * card image and a character string enclosed in single quotes starting in
     * column 11 or higher, indicates that the quoted string should be treated
     * as a continuation of the character string value in the previous key
     * keyword. To conform to this convention, the character string value on the
     * previous keyword must end with the ampersand character ('&amp;amp;'), but the
     * ampersand is not part of the value string and should be deleted before
     * concatenating the strings together. The character string value may be
     * continued on any number of consecutive CONTINUE keywords, thus
     * effectively allowing arbitrarily long strings to be written as keyword
     * values.
     */
<span class="fc" id="L162">    CONTINUE(SOURCE.HEASARC, HDU.ANY, VALUE.NONE, &quot;denotes the CONTINUE long string keyword convention&quot;),</span>
    
    /**
     * This keyword is used to indicate a rotation from a standard coordinate
     * system described by the CTYPEn to a different coordinate system in which
     * the values in the array are actually expressed. Rules for such rotations
     * are not further specified in the Standard; the rotation should be
     * explained in comments. The value field shall contain a floating point
     * number giving the rotation angle in degrees between axis n and the
     * direction implied by the coordinate system defined by CTYPEn. In unit
     * degrees.
     */
<span class="fc" id="L174">    CROTAn(SOURCE.RESERVED, HDU.IMAGE, VALUE.REAL, &quot;coordinate system rotation angle&quot;),</span>

    /**
     * The value field shall contain a floating point number, identifying the
     * location of a reference point along axis n, in units of the axis index.
     * This value is based upon a counter that runs from 1 to NAXISn with an
     * increment of 1 per pixel. The reference point value need not be that for
     * the center of a pixel nor lie within the actual data array. Use comments
     * to indicate the location of the index point relative to the pixel.
     */
<span class="fc" id="L184">    CRPIXn(SOURCE.RESERVED, HDU.IMAGE, VALUE.REAL, &quot;coordinate system reference pixel&quot;),</span>

    /**
     * The value field shall contain a floating point number, giving the value
     * of the coordinate specified by the CTYPEn keyword at the reference point
     * CRPIXn. Units must follow the prescriptions of section 5.3 of the FITS
     * Standard.
     */
<span class="fc" id="L192">    CRVALn(SOURCE.RESERVED, HDU.IMAGE, VALUE.REAL, &quot;coordinate system value at reference pixel&quot;),</span>

    /**
     * The value field shall contain a character string, giving the name of the
     * coordinate represented by axis n.
     */
<span class="fc" id="L198">    CTYPEn(SOURCE.RESERVED, HDU.IMAGE, VALUE.STRING, &quot;name of the coordinate axis&quot;),</span>

    /**
     * The value field shall always contain a floating point number, regardless
     * of the value of BITPIX. This number shall give the maximum valid physical
     * value represented by the array, exclusive of any special values.
     */
<span class="fc" id="L205">    DATAMAX(SOURCE.RESERVED, HDU.IMAGE, VALUE.REAL, &quot;maximum data value&quot;),</span>

    /**
     * The value field shall always contain a floating point number, regardless
     * of the value of BITPIX. This number shall give the minimum valid physical
     * value represented by the array, exclusive of any special values.
     */
<span class="fc" id="L212">    DATAMIN(SOURCE.RESERVED, HDU.IMAGE, VALUE.REAL, &quot;minimum data value&quot;),</span>

    /**
     * The date on which the HDU was created, in the format specified in the
     * FITS Standard. The old date format was 'yy/mm/dd' and may be used only
     * for dates from 1900 through 1999. the new Y2K compliant date format is
     * 'yyyy-mm-dd' or 'yyyy-mm-ddTHH:MM:SS[.sss]'.
     */

<span class="fc" id="L221">    DATE(SOURCE.RESERVED, HDU.ANY, VALUE.STRING, &quot;date of file creation&quot;),</span>

    /**
     * The date of the observation, in the format specified in the FITS
     * Standard. The old date format was 'yy/mm/dd' and may be used only for
     * dates from 1900 through 1999. The new Y2K compliant date format is
     * 'yyyy-mm-dd' or 'yyyy-mm-ddTHH:MM:SS[.sss]'.
     */
<span class="fc" id="L229">    DATE_OBS(&quot;DATE-OBS&quot;, SOURCE.RESERVED, HDU.ANY, VALUE.STRING, &quot;date of the observation&quot;),</span>

    /**
     * This keyword has no associated value. Columns 9-80 shall be filled with
     * ASCII blanks.
     */
<span class="fc" id="L235">    END(SOURCE.MANDATORY, HDU.ANY, VALUE.NONE, null),</span>

    /**
     * The value field shall contain a floating point number giving the equinox
     * in years for the celestial coordinate system in which positions are
     * expressed. Starting with Version 1, the Standard has deprecated the use
     * of the EPOCH keyword and thus it shall not be used in FITS files created
     * after the adoption of the standard; rather, the EQUINOX keyword shall be
     * used.
     * 
     * @deprecated use {@link #EQUINOX} in stead
     */
<span class="fc" id="L247">    @Deprecated</span>
    EPOCH(SOURCE.RESERVED, HDU.ANY, VALUE.REAL, &quot;equinox of celestial coordinate system&quot;),
    /**
     * The value field shall contain a floating point number giving the equinox
     * in years for the celestial coordinate system in which positions are
     * expressed.
     */
<span class="fc" id="L254">    EQUINOX(SOURCE.RESERVED, HDU.ANY, VALUE.REAL, &quot;equinox of celestial coordinate system&quot;),</span>

    /**
     * If the FITS file may contain extensions, a card image with the keyword
     * EXTEND and the value field containing the logical value T must appear in
     * the primary key immediately after the last NAXISn card image, or, if
     * NAXIS=0, the NAXIS card image. The presence of this keyword with the
     * value T in the primary key does not require that extensions be present.
     */
<span class="fc" id="L263">    EXTEND(SOURCE.RESERVED, HDU.PRIMARY, VALUE.LOGICAL, &quot;may the FITS file contain extensions?&quot;, //</span>
<span class="fc" id="L264">            replaceable(&quot;basichdu:extend&quot;, BasicHDU.class, &quot;Allow extensions&quot;), //</span>
<span class="fc" id="L265">            replaceable(&quot;header:extend&quot;, Object.class, &quot;Extensions are permitted&quot;), //</span>
<span class="fc" id="L266">            replaceable(&quot;imagedata:extend&quot;, ImageData.class, &quot;Extension permitted&quot;), //</span>
<span class="fc" id="L267">            replaceable(&quot;undefineddata:extend&quot;, UndefinedData.class, &quot;Extensions are permitted&quot;)</span>

    ),

    /**
     * The value field shall contain an integer, specifying the level in a
     * hierarchy of extension levels of the extension key containing it. The
     * value shall be 1 for the highest level; levels with a higher value of
     * this keyword shall be subordinate to levels with a lower value. If the
     * EXTLEVEL keyword is absent, the file should be treated as if the value
     * were 1. This keyword is used to describe an extension and should not
     * appear in the primary key.RANGE: [1:] DEFAULT: 1
     */
<span class="fc" id="L280">    EXTLEVEL(SOURCE.RESERVED, HDU.EXTENSION, VALUE.INTEGER, &quot;hierarchical level of the extension&quot;),</span>

    /**
     * The value field shall contain a character string, to be used to
     * distinguish among different extensions of the same type, i.e., with the
     * same value of XTENSION, in a FITS file. This keyword is used to describe
     * an extension and should not appear in the primary key.
     */
<span class="fc" id="L288">    EXTNAME(SOURCE.RESERVED, HDU.EXTENSION, VALUE.STRING, &quot;name of the extension&quot;),</span>

    /**
     * The value field shall contain an integer, to be used to distinguish among
     * different extensions in a FITS file with the same type and name, i.e.,
     * the same values for XTENSION and EXTNAME. The values need not start with
     * 1 for the first extension with a particular value of EXTNAME and need not
     * be in sequence for subsequent values. If the EXTVER keyword is absent,
     * the file should be treated as if the value were 1. This keyword is used
     * to describe an extension and should not appear in the primary key.RANGE:
     * [1:] DEFAULT: 1
     */
<span class="fc" id="L300">    EXTVER(SOURCE.RESERVED, HDU.EXTENSION, VALUE.INTEGER, &quot;version of the extension&quot;),</span>

    /**
     * The value field shall contain an integer that shall be used in any way
     * appropriate to define the data structure, consistent with Eq. 5.2 in the
     * FITS Standard. This keyword originated for use in FITS Random Groups
     * where it specifies the number of random groups present. In most other
     * cases this keyword will have the value 1.
     */
<span class="fc" id="L309">    GCOUNT(SOURCE.MANDATORY, HDU.EXTENSION, VALUE.INTEGER, &quot;group count&quot;, //</span>
<span class="fc" id="L310">            replaceable(&quot;randomgroupsdata:gcount&quot;, RandomGroupsData.class), //</span>
<span class="fc" id="L311">            replaceable(&quot;asciitable:gcount&quot;, AsciiTable.class), //</span>
<span class="fc" id="L312">            replaceable(&quot;basichdu:gcount&quot;, Object.class, &quot;Required value&quot;), //</span>
<span class="fc" id="L313">            replaceable(&quot;binarytable:gcount&quot;, BinaryTable.class), //</span>
<span class="fc" id="L314">            replaceable(&quot;imagedata:gcount&quot;, ImageData.class, &quot;No extra parameters&quot;), //</span>
<span class="fc" id="L315">            replaceable(&quot;undefineddata:gcount&quot;, UndefinedData.class)</span>

    ),

    /**
     * The value field shall contain the logical constant T. The value T
     * associated with this keyword implies that random groups records are
     * present.
     */
<span class="fc" id="L324">    GROUPS(SOURCE.MANDATORY, HDU.GROUPS, VALUE.LOGICAL, &quot;indicates random groups structure&quot;, //</span>
<span class="fc" id="L325">            replaceable(&quot;randomgroupsdata:groups&quot;, RandomGroupsData.class) //</span>
    ),

    /**
     * This keyword shall have no associated value; columns 9-80 may contain any
     * ASCII text. The text should contain a history of steps and procedures
     * associated with the processing of the associated data. Any number of
     * HISTORY card images may appear in a key.
     */
<span class="fc" id="L334">    HISTORY(SOURCE.RESERVED, HDU.ANY, VALUE.NONE, &quot;processing history of the data&quot;),</span>

    /**
     * The value field shall contain a character string identifying the
     * instrument used to acquire the data associated with the key.
     */
<span class="fc" id="L340">    INSTRUME(SOURCE.RESERVED, HDU.ANY, VALUE.STRING, &quot;name of instrument&quot;),</span>

    /**
     * The value field shall contain a non-negative integer no greater than 999,
     * representing the number of axes in the associated data array. A value of
     * zero signifies that no data follow the key in the HDU. In the context of
     * FITS 'TABLE' or 'BINTABLE' extensions, the value of NAXIS is always
     * 2.RANGE: [0:999]
     */
<span class="fc" id="L349">    NAXIS(SOURCE.MANDATORY, HDU.ANY, VALUE.INTEGER, &quot;number of axes&quot;, //</span>
<span class="fc" id="L350">            replaceable(&quot;header:naxis&quot;, Object.class) //</span>
    ),

    /**
     * The value field of this indexed keyword shall contain a non-negative
     * integer, representing the number of elements along axis n of a data
     * array. The NAXISn must be present for all values n = 1,...,NAXIS, and for
     * no other values of n. A value of zero for any of the NAXISn signifies
     * that no data follow the key in the HDU. If NAXIS is equal to 0, there
     * should not be any NAXISn keywords.RANGE: [0:]
     */
<span class="fc" id="L361">    NAXISn(SOURCE.MANDATORY, HDU.ANY, VALUE.INTEGER, &quot;size of the n'th axis&quot;, //</span>
<span class="fc" id="L362">            replaceable(&quot;asciitable:naxis1&quot;, AsciiTable.class, &quot;Size of row in bytes&quot;), //</span>
<span class="fc" id="L363">            replaceable(&quot;binarytable:naxis1&quot;, BinaryTable.class, &quot;Bytes per row&quot;), //</span>
<span class="fc" id="L364">            replaceable(&quot;randomgroupsdata:naxis1&quot;, RandomGroupsData.class), //</span>
<span class="fc" id="L365">            replaceable(&quot;randomgroupsdata:naxisN&quot;, RandomGroupsData.class), //</span>
<span class="fc" id="L366">            replaceable(&quot;tablehdu:naxis2&quot;, TableData.class), //</span>
<span class="fc" id="L367">            replaceable(&quot;header:naxisN&quot;, Object.class), //</span>
<span class="fc" id="L368">            replaceable(&quot;undefineddata:naxis1&quot;, UndefinedData.class, &quot;Number of Bytes&quot;) //</span>
    ),

    /**
     * The value field shall contain a character string giving a name for the
     * object observed.
     */
<span class="fc" id="L375">    OBJECT(SOURCE.RESERVED, HDU.ANY, VALUE.STRING, &quot;name of observed object&quot;),</span>

    /**
     * The value field shall contain a character string identifying who acquired
     * the data associated with the key.
     */
<span class="fc" id="L381">    OBSERVER(SOURCE.RESERVED, HDU.ANY, VALUE.STRING, &quot;observer who acquired the data&quot;),</span>

    /**
     * The value field shall contain a character string identifying the
     * organization or institution responsible for creating the FITS file.
     */
<span class="fc" id="L387">    ORIGIN(SOURCE.RESERVED, HDU.ANY, VALUE.STRING, &quot;organization responsible for the data&quot;),</span>

    /**
     * The value field shall contain an integer that shall be used in any way
     * appropriate to define the data structure, consistent with Eq. 5.2 in the
     * FITS Standard. This keyword was originated for use with FITS Random
     * Groups and represented the number of parameters preceding each group. It
     * has since been used in 'BINTABLE' extensions to represent the size of the
     * data heap following the main data table. In most other cases its value
     * will be zero.
     */
<span class="fc" id="L398">    PCOUNT(SOURCE.MANDATORY, HDU.EXTENSION, VALUE.INTEGER, &quot;parameter count&quot;, //</span>
<span class="fc" id="L399">            replaceable(&quot;asciitable:pcount&quot;, AsciiTable.class, &quot;No group data&quot;), //</span>
<span class="fc" id="L400">            replaceable(&quot;basichdu:pcount&quot;, Object.class, &quot;Required value&quot;), //</span>
<span class="fc" id="L401">            replaceable(&quot;binarytablehdu:pcount&quot;, BinaryTable.class, &quot;Includes heap&quot;), //</span>
<span class="fc" id="L402">            replaceable(&quot;binarytable:pcount&quot;, BinaryTable.class), //</span>
<span class="fc" id="L403">            replaceable(&quot;imagedata:pcount&quot;, ImageData.class, &quot;One group&quot;), //</span>
<span class="fc" id="L404">            replaceable(&quot;randomgroupsdata:pcount&quot;, RandomGroupsData.class), //</span>
<span class="fc" id="L405">            replaceable(&quot;undefineddata:pcount&quot;, UndefinedData.class) //</span>

    ),

    /**
     * This keyword is reserved for use within the FITS Random Groups structure.
     * This keyword shall be used, along with the PZEROn keyword, when the nth
     * FITS group parameter value is not the true physical value, to transform
     * the group parameter value to the true physical values it represents,
     * using the equation, physical_value = PZEROn + PSCALn *
     * group_parameter_value. The value field shall contain a floating point
     * number representing the coefficient of the linear term, the scaling
     * factor between true values and group parameter values at zero offset. The
     * default value for this keyword is 1.0.
     */
<span class="fc" id="L420">    PSCALn(SOURCE.RESERVED, HDU.GROUPS, VALUE.REAL, &quot;parameter scaling factor&quot;),</span>

    /**
     * This keyword is reserved for use within the FITS Random Groups structure.
     * The value field shall contain a character string giving the name of
     * parameter n. If the PTYPEn keywords for more than one value of n have the
     * same associated name in the value field, then the data value for the
     * parameter of that name is to be obtained by adding the derived data
     * values of the corresponding parameters. This rule provides a mechanism by
     * which a random parameter may have more precision than the accompanying
     * data array elements; for example, by summing two 16-bit values with the
     * first scaled relative to the other such that the sum forms a number of up
     * to 32-bit precision.
     */
<span class="fc" id="L434">    PTYPEn(SOURCE.RESERVED, HDU.GROUPS, VALUE.STRING, &quot;name of random groups parameter&quot;),</span>

    /**
     * This keyword is reserved for use within the FITS Random Groups structure.
     * This keyword shall be used, along with the PSCALn keyword, when the nth
     * FITS group parameter value is not the true physical value, to transform
     * the group parameter value to the physical value. The value field shall
     * contain a floating point number, representing the true value
     * corresponding to a group parameter value of zero. The default value for
     * this keyword is 0.0. The transformation equation is as follows:
     * physical_value = PZEROn + PSCALn * group_parameter_value.DEFAULT: 0.0
     */
<span class="fc" id="L446">    PZEROn(SOURCE.RESERVED, HDU.GROUPS, VALUE.REAL, &quot;parameter scaling zero point&quot;),</span>

    /**
     * Coordinate reference frame of major/minor axes.If absent the default
     * value is 'FK5'.
     */
<span class="fc" id="L452">    RADESYS(SOURCE.RESERVED, HDU.ANY, VALUE.STRING, &quot;Coordinate reference frame of major/minor axes.&quot;),</span>
    
    /**
     * Coordinate reference frame of major/minor axes. use RADESYS instead.
     * 
     * @deprecated use {@link #RADESYS} instead.
     */
<span class="fc" id="L459">    @Deprecated</span>
    RADECSYS(SOURCE.RESERVED, HDU.ANY, VALUE.STRING, &quot;Coordinate reference frame of major/minor axes.&quot;),

    /**
     * The value field shall contain a character string citing a reference where
     * the data associated with the key are published.
     */
<span class="fc" id="L466">    REFERENC(SOURCE.RESERVED, HDU.ANY, VALUE.STRING, &quot;bibliographic reference&quot;),</span>

    /**
     * The SIMPLE keyword is required to be the first keyword in the primary key
     * of all FITS files. The value field shall contain a logical constant with
     * the value T if the file conforms to the standard. This keyword is
     * mandatory for the primary key and is not permitted in extension headers.
     * A value of F signifies that the file does not conform to this standard.
     */
<span class="fc" id="L475">    SIMPLE(SOURCE.MANDATORY, HDU.PRIMARY, VALUE.LOGICAL, &quot;does file conform to the Standard?&quot;, //</span>
<span class="fc" id="L476">            replaceable(&quot;header:simple&quot;, Object.class, &quot;Java FITS: &quot; + new java.util.Date()) //</span>
    ),

    /**
     * The value field of this indexed keyword shall contain an integer
     * specifying the column in which field n starts in an ASCII TABLE
     * extension. The first column of a row is numbered 1.RANGE: [1:]
     */
<span class="fc" id="L484">    TBCOLn(SOURCE.MANDATORY, HDU.ASCII_TABLE, VALUE.INTEGER, &quot;begining column number&quot;, //</span>
<span class="fc" id="L485">            replaceable(&quot;asciitable:tbcolN&quot;, AsciiTable.class, &quot;Column offset&quot;) //</span>
    ),

    /**
     * The value field of this indexed keyword shall contain a character string
     * describing how to interpret the contents of field n as a multidimensional
     * array, providing the number of dimensions and the length along each axis.
     * The form of the value is not further specified by the Standard. A
     * proposed convention is described in Appendix B.2 of the FITS Standard in
     * which the value string has the format '(l,m,n...)' where l, m, n,... are
     * the dimensions of the array.
     */
<span class="fc" id="L497">    TDIMn(SOURCE.RESERVED, HDU.BINTABLE, VALUE.STRING, &quot;dimensionality of the array &quot;, //</span>
<span class="fc" id="L498">            replaceable(&quot;binarytablehdu:tdimN&quot;, BinaryTable.class), //</span>
<span class="fc" id="L499">            replaceable(&quot;headercard:tdimN&quot;, Object.class) //</span>
    ),

    /**
     * The value field of this indexed keyword shall contain a character string
     * describing the format recommended for the display of the contents of
     * field n. If the table value has been scaled, the physical value shall be
     * displayed. All elements in a field shall be displayed with a single,
     * repeated format. For purposes of display, each byte of bit (type X) and
     * byte (type B) arrays is treated as an unsigned integer. Arrays of type A
     * may be terminated with a zero byte. Only the format codes in Table 8.6,
     * discussed in section 8.3.4 of the FITS Standard, are permitted for
     * encoding. The format codes must be specified in upper case. If the Bw.m,
     * Ow.m, and Zw.m formats are not readily available to the reader, the Iw.m
     * display format may be used instead, and if the ENw.d and ESw.d formats
     * are not available, Ew.d may be used. The meaning of this keyword is not
     * defined for fields of type P in the Standard but may be defined in
     * conventions using such fields.
     */
<span class="fc" id="L518">    TDISPn(SOURCE.RESERVED, HDU.TABLE, VALUE.STRING, &quot;display format&quot;),</span>
   
    /**
     * The value field shall contain a character string identifying the
     * telescope used to acquire the data associated with the key.
     */
<span class="fc" id="L524">    TELESCOP(SOURCE.RESERVED, HDU.ANY, VALUE.STRING, &quot;name of telescope&quot;),</span>

    /**
     * The value field shall contain a non-negative integer representing the
     * number of fields in each row of a 'TABLE' or 'BINTABLE' extension. The
     * maximum permissible value is 999. RANGE: [0:999]
     */
<span class="fc" id="L531">    TFIELDS(SOURCE.MANDATORY, HDU.TABLE, VALUE.INTEGER, &quot;number of columns in the table&quot;, //</span>
<span class="fc" id="L532">            replaceable(&quot;asciitablehdu:tfields&quot;, AsciiTable.class), //</span>
<span class="fc" id="L533">            replaceable(&quot;binarytable:tfields&quot;, BinaryTable.class), //</span>
<span class="fc" id="L534">            replaceable(&quot;tablehdu:tfields&quot;, TableData.class, &quot;Number of table fields&quot;), //</span>
<span class="fc" id="L535">            replaceable(&quot;asciitable:tfields&quot;, AsciiTable.class, &quot;Number of fields in table&quot;) //</span>
    ),
    /**
     * The value field of this indexed keyword shall contain a character string
     * describing the format in which field n is encoded in a 'TABLE' or
     * 'BINTABLE' extension.
     */
<span class="fc" id="L542">    TFORMn(SOURCE.MANDATORY, HDU.TABLE, VALUE.STRING, &quot;column data format&quot;, //</span>
<span class="fc" id="L543">            replaceable(&quot;asciitable:tformN&quot;, AsciiTable.class), //</span>
<span class="fc" id="L544">            replaceable(&quot;binarytable:tformN&quot;, BinaryTable.class) //</span>

    ),

    /**
     * The value field of this keyword shall contain an integer providing the
     * separation, in bytes, between the start of the main data table and the
     * start of a supplemental data area called the heap. The default value
     * shall be the product of the values of NAXIS1 and NAXIS2. This keyword
     * shall not be used if the value of PCOUNT is zero. A proposed application
     * of this keyword is presented in Appendix B.1 of the FITS Standard.
     */
<span class="fc" id="L556">    THEAP(SOURCE.RESERVED, HDU.BINTABLE, VALUE.INTEGER, &quot;offset to starting data heap address&quot;, //</span>
<span class="fc" id="L557">            replaceable(&quot;binarytablehdu:theap&quot;, BinaryTable.class) //</span>
    ),
  
    /**
     * In ASCII 'TABLE' extensions, the value field for this indexed keyword
     * shall contain the character string that represents an undefined value for
     * field n. The string is implicitly blank filled to the width of the field.
     * In binary 'BINTABLE' table extensions, the value field for this indexed
     * keyword shall contain the integer that represents an undefined value for
     * field n of data type B, I, or J. The keyword may not be used in
     * 'BINTABLE' extensions if field n is of any other data type.
     */
<span class="fc" id="L569">    TNULLn(SOURCE.RESERVED, HDU.TABLE, VALUE.STRING, &quot;value used to indicate undefined table element&quot;),</span>

    /**
     * This indexed keyword shall be used, along with the TZEROn keyword, when
     * the quantity in field n does not represent a true physical quantity. The
     * value field shall contain a floating point number representing the
     * coefficient of the linear term in the equation, physical_value = TZEROn +
     * TSCALn * field_value, which must be used to compute the true physical
     * value of the field, or, in the case of the complex data types C and M, of
     * the real part of the field with the imaginary part of the scaling factor
     * set to zero. The default value for this keyword is 1.0. This keyword may
     * not be used if the format of field n is A, L, or X.DEFAULT: 1.0
     */
<span class="fc" id="L582">    TSCALn(SOURCE.RESERVED, HDU.TABLE, VALUE.REAL, &quot;linear data scaling factor&quot;),</span>

    /**
     * The value field for this indexed keyword shall contain a character
     * string, giving the name of field n. It is recommended that only letters,
     * digits, and underscore (hexadecimal code 5F, ('_') be used in the name.
     * String comparisons with the values of TTYPEn keywords should not be case
     * sensitive. The use of identical names for different fields should be
     * avoided.
     */
<span class="fc" id="L592">    TTYPEn(SOURCE.RESERVED, HDU.TABLE, VALUE.STRING, &quot;column name&quot;),</span>

    /**
     * The value field shall contain a character string describing the physical
     * units in which the quantity in field n, after any application of TSCALn
     * and TZEROn, is expressed. The units of all FITS key keyword values, with
     * the exception of measurements of angles, should conform with the
     * recommendations in the IAU Style Manual. For angular measurements given
     * as floating point values and specified with reserved keywords, degrees
     * are the recommended units (with the units, if specified, given as 'deg').
     */
<span class="fc" id="L603">    TUNITn(SOURCE.RESERVED, HDU.TABLE, VALUE.STRING, &quot;column units&quot;),</span>

    /**
     * This indexed keyword shall be used, along with the TSCALn keyword, when
     * the quantity in field n does not represent a true physical quantity. The
     * value field shall contain a floating point number representing the true
     * physical value corresponding to a value of zero in field n of the FITS
     * file, or, in the case of the complex data types C and M, in the real part
     * of the field, with the imaginary part set to zero. The default value for
     * this keyword is 0.0. This keyword may not be used if the format of field
     * n is A, L, or X.DEFAULT: 0.0
     */
<span class="fc" id="L615">    TZEROn(SOURCE.RESERVED, HDU.TABLE, VALUE.REAL, &quot;column scaling zero point&quot;),</span>

    /**
     * The value field shall contain a character string giving the name of the
     * extension type. This keyword is mandatory for an extension key and must
     * not appear in the primary key. For an extension that is not a standard
     * extension, the type name must not be the same as that of a standard
     * extension.
     */
<span class="fc" id="L624">    XTENSION(SOURCE.MANDATORY, HDU.EXTENSION, VALUE.STRING, &quot;marks beginning of new HDU&quot;);</span>

<span class="fc" id="L626">    public static final IFitsHeader NAXIS1 = NAXISn.n(1);</span>

<span class="fc" id="L628">    public static final IFitsHeader NAXIS2 = NAXISn.n(2);</span>

<span class="fc" id="L630">    private static final ThreadLocal&lt;Class&lt;?&gt;&gt; COMMENT_CONTEXT = new ThreadLocal&lt;&gt;();</span>

    /**
     * The value of the XTENSION keword in case of a binary table.
     */
    public static final String XTENSION_BINTABLE = &quot;BINTABLE&quot;;

    /**
     * The value of the XTENSION keword in case of an image.
     */
    public static final String XTENSION_IMAGE = &quot;IMAGE&quot;;

    private final StandardCommentReplacement[] commentReplacements;

    @SuppressWarnings(&quot;CPD-START&quot;)
    private final IFitsHeader key;

<span class="fc" id="L647">    Standard(SOURCE status, HDU hdu, VALUE valueType, String comment, StandardCommentReplacement... replacements) {</span>
<span class="fc" id="L648">        this.key = new FitsHeaderImpl(name(), status, hdu, valueType, comment);</span>
<span class="fc" id="L649">        this.commentReplacements = replacements;</span>
<span class="fc" id="L650">    }</span>

<span class="fc" id="L652">    Standard(String headerName, SOURCE status, HDU hdu, VALUE valueType, String comment, StandardCommentReplacement... replacements) {</span>
<span class="pc bpc" id="L653" title="1 of 2 branches missed.">        this.key = new FitsHeaderImpl(headerName == null ? name() : headerName, status, hdu, valueType, comment);</span>
<span class="fc" id="L654">        this.commentReplacements = replacements;</span>
<span class="fc" id="L655">    }</span>

    @Override
    public String comment() {
<span class="fc" id="L659">        Class&lt;?&gt; contextClass = COMMENT_CONTEXT.get();</span>
<span class="fc bfc" id="L660" title="All 2 branches covered.">        if (contextClass == null) {</span>
<span class="fc" id="L661">            contextClass = Object.class;</span>
        }
<span class="fc bfc" id="L663" title="All 2 branches covered.">        for (StandardCommentReplacement stdCommentReplacement : commentReplacements) {</span>
<span class="fc bfc" id="L664" title="All 2 branches covered.">            if (stdCommentReplacement.getContext().isAssignableFrom(contextClass)) {</span>
<span class="fc bfc" id="L665" title="All 2 branches covered.">                if (stdCommentReplacement.getComment() != null) {</span>
<span class="fc" id="L666">                    return stdCommentReplacement.getComment();</span>
                }
            }
        }
<span class="fc" id="L670">        return this.key.comment();</span>
    }

    @Override
    public HDU hdu() {
<span class="fc" id="L675">        return this.key.hdu();</span>
    }

    @Override
    public String key() {
<span class="fc" id="L680">        return this.key.key();</span>
    }

    @Override
    public IFitsHeader n(int... number) {
<span class="fc" id="L685">        return this.key.n(number);</span>
    }

    @Override
    public SOURCE status() {
<span class="fc" id="L690">        return this.key.status();</span>
    }

    @Override
    @SuppressWarnings(&quot;CPD-END&quot;)
    public VALUE valueType() {
<span class="fc" id="L696">        return this.key.valueType();</span>
    }

    public static void context(Class&lt;?&gt; clazz) {
<span class="fc" id="L700">        COMMENT_CONTEXT.set(clazz);</span>
<span class="fc" id="L701">    }</span>

    /**
     * scan for a comment with the specified reference key.
     * 
     * @param commentKey
     *            the reference key
     * @return the comment for the reference key
     */
    public String getCommentByKey(String commentKey) {
<span class="fc bfc" id="L711" title="All 2 branches covered.">        for (StandardCommentReplacement commentReplacement : commentReplacements) {</span>
<span class="fc bfc" id="L712" title="All 2 branches covered.">            if (commentReplacement.getRef().equals(commentKey)) {</span>
<span class="fc" id="L713">                String foundcommentReplacement = commentReplacement.getComment();</span>
<span class="fc bfc" id="L714" title="All 2 branches covered.">                if (foundcommentReplacement == null) {</span>
<span class="fc" id="L715">                    return comment();</span>
                }
<span class="fc" id="L717">                return foundcommentReplacement;</span>
            }
        }
<span class="fc" id="L720">        return null;</span>
    }

    /**
     * set the comment for the specified reference key.
     * 
     * @param commentKey
     *            the reference key
     * @param value
     *            the comment to set when the fits key is used.
     */
    public void setCommentByKey(String commentKey, String value) {
<span class="fc bfc" id="L732" title="All 2 branches covered.">        for (StandardCommentReplacement commentReplacement : commentReplacements) {</span>
<span class="fc bfc" id="L733" title="All 2 branches covered.">            if (commentReplacement.getRef().equals(commentKey)) {</span>
<span class="fc" id="L734">                commentReplacement.setComment(value);</span>
<span class="fc" id="L735">                return;</span>
            }
        }
<span class="fc" id="L738">    }</span>

    private static StandardCommentReplacement replaceable(String string, Class&lt;?&gt; clazz) {
<span class="fc" id="L741">        return new StandardCommentReplacement(string, clazz);</span>
    }

    private static StandardCommentReplacement replaceable(String string, Class&lt;?&gt; clazz, String comment) {
<span class="fc" id="L745">        return new StandardCommentReplacement(string, clazz, comment);</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>